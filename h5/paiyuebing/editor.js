(function(){function q(a,c){return(c||document).querySelector(a)}function C(a,c,l){a.attachEvent?a.attachEvent("on"+c,l):a.addEventListener(c,l,!1)}function r(a,c,l,n,p,m){a=x(x(c,a),x(n,m));return x(a<<p|a>>>32-p,l)}function s(a,c,l,n,p,m,k){return r(c&l|~c&n,a,c,p,m,k)}function t(a,c,l,n,p,m,k){return r(c&n|l&~n,a,c,p,m,k)}function u(a,c,l,n,p,m,k){return r(l^(c|~n),a,c,p,m,k)}function x(a,c){var l=(a&65535)+(c&65535);return(a>>16)+(c>>16)+(l>>16)<<16|l&65535}function A(a){q("#promptLayer").style.display=
"block";q("#promptLayer .txt").style.width=y+"px";q("#promptLayer .txt").style.height=B+"px";q("#promptLayer .txt").innerHTML=a}function z(){q("#promptLayer").style.display="none"}var v=document.createElement("canvas");v.width=v.height=1;0!==v.toDataURL("image/jpeg").indexOf("data:image/jpeg")&&(v=document.createElement("script"),v.type="text/javascript",v.src="/microblog-v3/2015subject/0211_chunjie/cvsjpeg.js",document.body.insertBefore(v,document.body.firstChild));-1===navigator.userAgent.indexOf("WebKit")&&
-1===navigator.userAgent.indexOf("Firefox")&&navigator.userAgent.indexOf("MSIE");var H=function(){function a(a,c,m,k,d){var b=a.getShortAt(c+2,d);k=a.getLongAt(c+4,d);m=a.getLongAt(c+8,d)+m;switch(b){case 1:case 7:if(1==k)return a.getByteAt(c+8,d);m=4<k?m:c+8;c=[];for(b=0;b<k;b++)c[b]=a.getByteAt(m+b);return c;case 2:return a.getStringAt(4<k?m:c+8,k-1);case 3:if(1==k)return a.getShortAt(c+8,d);m=2<k?m:c+8;c=[];for(b=0;b<k;b++)c[b]=a.getShortAt(m+2*b,d);return c;case 4:if(1==k)return a.getLongAt(c+
8,d);c=[];for(b=0;b<k;b++)c[b]=a.getLongAt(m+4*b,d);return c;case 5:if(1==k)return a.getLongAt(m,d)/a.getLongAt(m+4,d);c=[];for(b=0;b<k;b++)c[b]=a.getLongAt(m+8*b,d)/a.getLongAt(m+4+8*b,d);return c;case 9:if(1==k)return a.getSLongAt(c+8,d);c=[];for(b=0;b<k;b++)c[b]=a.getSLongAt(m+4*b,d);return c;case 10:if(1==k)return a.getSLongAt(m,d)/a.getSLongAt(m+4,d);c=[];for(b=0;b<k;b++)c[b]=a.getSLongAt(m+8*b,d)/a.getSLongAt(m+4+8*b,d);return c}}var c={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",
34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",
532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},l=function(a,c,m){var k=a,d=c||0,b=0;this.getRawData=function(){return k};"string"==typeof a?(b=m||k.length,this.getByteAt=function(a){return k.charCodeAt(a+d)&255}):"unknown"==typeof a&&(b=m||IEBinary_getLength(k),this.getByteAt=function(a){return IEBinary_getByteAt(k,a+d)});this.getLength=function(){return b};this.getSByteAt=function(a){a=this.getByteAt(a);return 127<
a?a-256:a};this.getShortAt=function(a,d){var b=d?(this.getByteAt(a)<<8)+this.getByteAt(a+1):(this.getByteAt(a+1)<<8)+this.getByteAt(a);0>b&&(b+=65536);return b};this.getSShortAt=function(a,d){var b=this.getShortAt(a,d);return 32767<b?b-65536:b};this.getLongAt=function(a,d){var b=this.getByteAt(a),c=this.getByteAt(a+1),k=this.getByteAt(a+2),m=this.getByteAt(a+3),b=d?(((b<<8)+c<<8)+k<<8)+m:(((m<<8)+k<<8)+c<<8)+b;0>b&&(b+=4294967296);return b};this.getSLongAt=function(a,d){var b=this.getLongAt(a,d);
return 2147483647<b?b-4294967296:b};this.getStringAt=function(a,d){for(var b=[],c=a,k=0;c<a+d;c++,k++)b[k]=String.fromCharCode(this.getByteAt(c));return b.join("")};this.getCharAt=function(a){return String.fromCharCode(this.getByteAt(a))};this.toBase64=function(){return window.btoa(k)};this.fromBase64=function(a){k=window.atob(a)}};return function(n,p){var m;a:{var k=new l(n);if(255!=k.getByteAt(0)||216!=k.getByteAt(1))m=!1;else{var d=2;for(m=k.getLength();d<m;){if(255!=k.getByteAt(d)){m=!1;break a}var b=
k.getByteAt(d+1);if(22400==b||225==b){b:if(m=k,b=d+4,k.getShortAt(d+2,!0),"Exif"!=m.getStringAt(b,4))m=!1;else{var e=void 0,k=b+6;if(18761==m.getShortAt(k))e=!1;else if(19789==m.getShortAt(k))e=!0;else{m=!1;break b}if(42!=m.getShortAt(k+2,e)||8!=m.getLongAt(k+4,e))m=!1;else{for(var d=k+8,b=c,f=m.getShortAt(d,e),g={},h=0;h<f;h++){var q=d+12*h+2,r=b[m.getShortAt(q,e)];g[r]=a(m,q,k,d,e)}m=g}}break a}d+=2+k.getShortAt(d+2,!0)}m=void 0}}return m[p]?m[p]:""}}(),E=navigator.userAgent.match(/ OS (\d+).*? Mac OS/)||
!1;navigator.userAgent.indexOf("NetType/WIFI");if(-1!==navigator.userAgent.indexOf("Messenger")&&"t.people.com.cn"!=location.host)location.href="http://t.people.com.cn/wx/paiyuebing";else{var F={name:"urlcache",get:function(a){if(/[&\\=\|\?%]/.test(a))window.console&&console.log("name\u4e0d\u80fd\u5305\u542b\u7279\u6b8a\u7b26\u53f7:"+a);else if(window.localStorage&&(a=(window.localStorage[this.name]||"").match(RegExp("(?:^|&)"+a+"=([^&]*)"))))return decodeURIComponent(a[1])},set:function(a,c){if(/[&\\=\|\?%]/.test(a))return window.console&&
console.log("name\u4e0d\u80fd\u5305\u542b\u7279\u6b8a\u7b26\u53f7:"+a),!1;if(window.localStorage){var l=window.localStorage[this.name]||"",l=void 0===this.get(a)?l+((""===l?"":"&")+a+"="+c.replace(/&/g,"%26").replace(/=/g,"%3D")):l.replace(RegExp("(^|&)"+a+"=([^&]*)"),"$1"+a+"="+encodeURIComponent(c));window.localStorage[this.name]=l;return!0}return!1},del:function(a){if(/[&\\=\|\?%]/.test(a))return alert("name\u4e0d\u80fd\u5305\u542b\u7279\u6b8a\u7b26\u53f7"),!1;if(window.localStorage&&void 0!==
this.get(a)){var c=window.localStorage[this.name]||"",c=c.replace(RegExp("(^|&)"+a+"=([^&]*)"),"");window.localStorage[this.name]=c.replace(/^&/,"");return!0}return!1},clear:function(){window.localStorage&&(window.localStorage[this.name]="")}},w={ready:!0,limit:7,maxWidth:640,maxHeight:800,type:"*",num:0,multiple:!0,init:function(){var a=this;this.fileRef=document.createElement("div");this.fileRef.style.width="1px";this.fileRef.style.height="1px";this.fileRef.style.overflow="hidden";this.fileRef.style.position=
"absolute";this.fileRef.style.zIndex=900;this.fileRef.style.left="-10px";this.fileRef.style.top="-10px";document.body.appendChild(this.fileRef);this.form=document.createElement("form");this.form.className="ente_uploadForm";this.form.setAttribute("target","enteUploadImgFrame");this.form.setAttribute("enctype","multipart/form-data");this.form.setAttribute("method","post");this.form.style.width="260px";this.fileRef.appendChild(this.form);this.form.innerHTML='<div class="ente_f"><input type="file" multiple="multiple" accept="image/'+
this.type+'" name="upload" /></div>';this.file=q("input[type=file]",this.form);this.fileBox=q(".ente_f",this.form);this.form.style.opacity="0";if(E){var c=0,l=function(){c++;if(3<=c&&0==a.file.files.length&&"function"==typeof a.oncomplete){a.oncomplete();var n=l;document.detachEvent?document.detachEvent("ontouchstart",n):document.removeEventListener("touchstart",n,!1)}};this.file.onclick=function(){"function"==typeof a.onbegin&&(a.onbegin(),C(document,"touchstart",l))}}this.file.onchange=function(){E||
"function"!=typeof a.onbegin||(a.onbegin(),C(document,"touchstart",l));var c=l;document.detachEvent?document.detachEvent("ontouchstart",c):document.removeEventListener("touchstart",c,!1);a.setDisabled(!0);a._push(this)}},setMultiple:function(a){(this.multiple=!0===a)?this.file.setAttribute("multiple","multiple"):this.file.removeAttribute("multiple")},bind:function(a){var c=this;a="string"==typeof a?q(a):a;a.onmouseover=function(){c.coverTarget(a)};this.coverTarget(a)},unbind:function(a){a.onmouseover=
null},_loadQueue:[],_load:function(){if(this._loadQueue.length){var a=this._loadQueue.shift();a&&this._readExif(a)}},_push:function(a){_self=this;for(var c=this.num=this.sum=0;c<a.files.length&&!(c>=this.limit);c++)this._loadQueue.push(a.files[c]),this.sum++,_self._load()},_readExif:function(a,c){var l=this,n=(window.URL||window.webkitURL).createObjectURL(a);if(a)try{var p=new FileReader;p.onload=function(a){a=H(this.result,"Orientation");l._readFile(n,a,c)};p.onerror=function(a){l._readFile(n,0,
c)};p.readAsBinaryString(a)}catch(m){this._readFile(n,0,c)}},_readFile:function(a,c,l){var n=this,p=new Image,m=c||0,k=navigator.userAgent.match(/ OS (\d+).*? Mac OS/)||!1;k&&(k=parseInt(k[1]));p.onload=function(){var a=p.width,b=p.height,c=a/b,f,g,h,l=1;3E3<Math.max(a,b)&&(a*=.8,b*=.8);if(k&&8>k){f=document.createElement("canvas");f.width=a;f.height=b;h=f.getContext("2d");h.drawImage(p,0,0,a,b);h=h.getImageData(0,0,1,b).data;for(var l=n._detectSquash(h,b,0),q=0;1!=l&&3>q;)q++,g=document.createElement("canvas"),
g.width=a,g.height=b,h=g.getContext("2d"),h.drawImage(f,0,0,a,b/l),h=h.getImageData(0,0,1,b).data,l=n._detectSquash(h,b,0),1!=l&&(a*=.8,b*=.8),f=g}else f=p;if(6==m||8==m)c=a,a=b,b=c,c=a/b;a>n.maxWidth&&(a=parseInt(n.maxWidth),b=parseInt(a/c));b>n.maxHeight&&(b=parseInt(n.maxHeight),a=parseInt(b*c));c=document.createElement("canvas");h=c.getContext("2d");c.width=a;c.height=b;switch(m){case 3:h.rotate(180*Math.PI/180);h.drawImage(f,-a,-b,a,b);break;case 6:h.rotate(90*Math.PI/180);h.drawImage(f,0,-a,
b,a);break;case 8:h.rotate(270*Math.PI/180);h.drawImage(f,-b,0,b,a);break;default:h.rotate(0),h.drawImage(f,0,0,a,b)}a=c.toDataURL("image/jpeg",k?.7:.86);c=n.zoomCanvas(c,160,160);c.getContext("2d");smallBase64=c.toDataURL("image/jpeg",.7);"function"==typeof n.onadd&&n.add(a,smallBase64);n._load()};p.onerror=function(){n.onerror("\u6ca1\u6709\u6743\u9650\u8bbf\u95ee\u6587\u4ef6");alert("\u7531\u4e8e\u5b89\u5168\u9650\u5236\uff0c\u65e0\u6cd5\u4ece\u624b\u673a\u4e2d\u8bfb\u53d6\u7167\u7247\uff0c\u8bf7\u5c1d\u8bd5\u5728\u6d4f\u89c8\u5668\u4e2d\u6253\u5f00\uff0c\u4f7f\u7528\u62cd\u7167\u4e0a\u4f20\u3002")};
p.src=a},zoomCanvas:function(a,c,l){var n,p,m,k,d=a.width,b=a.height;p=n=0;m=d;k=b;if(1.8<d/c){n=document.createElement("canvas");p=document.createElement("canvas");m=n.getContext("2d");k=p.getContext("2d");n.width=d;n.height=b;for(m.drawImage(a,0,0,d,b);1.8<d/c;)d=Math.round(.6*d),b=Math.round(.6*b),p.width=d,p.height=b,k.drawImage(n,0,0,d,b),n.width=d,n.height=b,m.drawImage(p,0,0,d,b);a=n}a.width>a.height?(m=a.height/l*c,k=a.height,n=(a.width-a.height/l*c)/2,p=0):(m=a.width,k=a.width/c*l,n=0,p=
(a.height-a.width/c*l)/2);d=document.createElement("canvas");d.width=c;d.height=l;d.getContext("2d").drawImage(a,n,p,m,k,0,0,c,l);return d},error:function(a){if("function"==typeof this.onerror)this.onerror(a);this.setDisabled(!1);this.file.value=""},add:function(a,c){if("function"==typeof this.onadd)this.onadd(a,c);this.num++;if("function"==typeof this.onprogress)this.onprogress(this.num/this.sum);if(this.num==this.sum&&(this.setDisabled(!1),this.file.value="","function"==typeof _self.oncomplete))_self.oncomplete()},
_detectSquash:function(a,c,l){switch(l){case 3:case 6:for(l=c-1;0<=l&&0!==a[4*l+3];l--);l=c-2-l;break;default:for(l=0;l<c&&0!==a[4*l+3];l++);--l}if(2>=c-l)return 1;a=l/(c-1);return 0>=a?1:a},coverTarget:function(a){this.target=a="string"==typeof a?q(a):a;var c=0,l=0,n=a;try{for(;null!=n&&n!=document.body&&n!=document.documentElement&&void 0!=n;)c+=n.offsetLeft,l+=n.offsetTop,n=n.offsetParent}catch(p){}this.fileRef.style.width=a.offsetWidth+"px";this.fileRef.style.height=a.offsetHeight+"px";this.fileRef.style.left=
c+"px";this.fileRef.style.top=l+"px";this.fileRef.style.display="block";this.revise||(-1!==navigator.userAgent.indexOf("MSIE 8")?this.fileBox.style.left="-183px":navigator.userAgent.match(/MSIE (9|10)/)?this.fileBox.style.left="-"+(15*this.fileBox.offsetWidth-this.target.offsetWidth)+"px":-1===navigator.userAgent.indexOf("MSIE")&&(this.fileBox.style.left="-100px"),this.revise=!0)},setDisabled:function(a){a=!!a;this.ready=!a;this.form.style.display=a?"none":"block"},hide:function(){this.fileRef.style.display=
"none"},show:function(){this.fileRef.style.display="block"}},G={page:1,items:[],limit:9,init:function(){var a=this;q("#btnPreview").onclick=function(){a.submit()};q("#phone").onfocus=function(){"\u8bf7\u8f93\u5165\u60a8\u7684\u624b\u673a\u53f7"==this.value&&(this.value="",this.className="phoneNumber")};q("#phone").onblur=function(){""==this.value&&(this.value="\u8bf7\u8f93\u5165\u60a8\u7684\u624b\u673a\u53f7",this.className="")};this.setPage(2)},setPage:function(a){2===a&&(q(".e_page_2").style.display=
"block",this.checkLimit(),this.page=2)},addImage:function(a,c){var l=this;if(!(this.items.length>=this.limit+1)){var n={};n.smallBase64=c;n.src=a;n.li=document.createElement("li");n.img=new Image;var p=document.createElement("span");n.img.src=c;n.li.appendChild(p);p.appendChild(n.img);p=document.createElement("div");p.className="itemDel";n.li.appendChild(p);q("#addItemBtn").parentNode.insertBefore(n.li,q("#addItemBtn"));n.li.onclick=function(){l.delItem(n)};this.items.push(n);this.checkLimit()}},
checkLimit:function(){this.items.length>=this.limit?(q("#addItemBtn").style.display="none",w.hide()):(q("#addItemBtn").style.display="block",w.coverTarget("#addImage"),w.show(),w.limit=this.limit-this.items.length)},preview:function(){this.phoneNumber=q("#phone").value;if(/^1[3-8]\d{9}$/.test(this.phoneNumber))if(1==this.items.length)alert("\u81f3\u5c11\u9700\u8981\u6dfb\u52a01\u5f20\u7167\u7247\uff0c\u8bf7\u70b9\u51fb\u201c+\u201d\u6309\u94ae\u6dfb\u52a0\u7167\u7247\u3002");else{for(var a="<ul>",
c=0;c<this.items.length;c++)a+='<li><img src="'+this.items[c].smallBase64+'" data-src="'+this.items[c].src+'" ></li>';a+="</ul>";q(".userPhone span").innerHTML=this.phoneNumber;q("#userPhotos").innerHTML=a;this.setPage(3)}else alert("\u4e3a\u4e86\u5b8c\u6210\u8bc4\u5956\uff0c\u8bf7\u6b63\u786e\u586b\u5199\u624b\u673a\u53f7\u7801\u3002")},submit:function(){this.phoneNumber=q("#phone").value;if(/^1[3-8]\d{9}$/.test(this.phoneNumber))if(1>this.items.length)alert("\u81f3\u5c11\u9700\u8981\u6dfb\u52a01\u5f20\u7167\u7247\uff0c\u8bf7\u70b9\u51fb\u201c+\u201d\u6309\u94ae\u6dfb\u52a0\u7167\u7247\u3002");
else{for(var a=0;a<this.items.length;a++);this.uploadImg()}else alert("\u4e3a\u4e86\u5b8c\u6210\u8bc4\u5956\uff0c\u8bf7\u6b63\u786e\u586b\u5199\u624b\u673a\u53f7\u7801\u3002")},delItem:function(a){if((a=a||this._changeItem)&&confirm("\u786e\u5b9a\u8981\u5220\u9664\u5f53\u524d\u7167\u7247\u5417\uff1f")){for(var c=[],l=0;l<this.items.length;l++)this.items[l]!=a?c.push(this.items[l]):a.li.parentNode.removeChild(a.li);this.items=c;this.checkLimit()}},uploadImg:function(){function a(){c.uploadIndex++;
if(c.uploadIndex>=c.items.length)c.uploadData();else{var k=c.items[c.uploadIndex];if(k.smallBase64){for(var d=k.smallBase64,b=[],e=0;e<8*d.length;e+=8)b[e>>5]|=(d.charCodeAt(e/8)&255)<<e%32;d=8*d.length;b[d>>5]|=128<<d%32;b[(d+64>>>9<<4)+14]=d;for(var d=1732584193,e=-271733879,f=-1732584194,g=271733878,h=0;h<b.length;h+=16)var l=d,n=e,p=f,q=g,d=s(d,e,f,g,b[h+0],7,-680876936),g=s(g,d,e,f,b[h+1],12,-389564586),f=s(f,g,d,e,b[h+2],17,606105819),e=s(e,f,g,d,b[h+3],22,-1044525330),d=s(d,e,f,g,b[h+4],7,
-176418897),g=s(g,d,e,f,b[h+5],12,1200080426),f=s(f,g,d,e,b[h+6],17,-1473231341),e=s(e,f,g,d,b[h+7],22,-45705983),d=s(d,e,f,g,b[h+8],7,1770035416),g=s(g,d,e,f,b[h+9],12,-1958414417),f=s(f,g,d,e,b[h+10],17,-42063),e=s(e,f,g,d,b[h+11],22,-1990404162),d=s(d,e,f,g,b[h+12],7,1804603682),g=s(g,d,e,f,b[h+13],12,-40341101),f=s(f,g,d,e,b[h+14],17,-1502002290),e=s(e,f,g,d,b[h+15],22,1236535329),d=t(d,e,f,g,b[h+1],5,-165796510),g=t(g,d,e,f,b[h+6],9,-1069501632),f=t(f,g,d,e,b[h+11],14,643717713),e=t(e,f,g,d,
b[h+0],20,-373897302),d=t(d,e,f,g,b[h+5],5,-701558691),g=t(g,d,e,f,b[h+10],9,38016083),f=t(f,g,d,e,b[h+15],14,-660478335),e=t(e,f,g,d,b[h+4],20,-405537848),d=t(d,e,f,g,b[h+9],5,568446438),g=t(g,d,e,f,b[h+14],9,-1019803690),f=t(f,g,d,e,b[h+3],14,-187363961),e=t(e,f,g,d,b[h+8],20,1163531501),d=t(d,e,f,g,b[h+13],5,-1444681467),g=t(g,d,e,f,b[h+2],9,-51403784),f=t(f,g,d,e,b[h+7],14,1735328473),e=t(e,f,g,d,b[h+12],20,-1926607734),d=r(e^f^g,d,e,b[h+5],4,-378558),g=r(d^e^f,g,d,b[h+8],11,-2022574463),f=r(g^
d^e,f,g,b[h+11],16,1839030562),e=r(f^g^d,e,f,b[h+14],23,-35309556),d=r(e^f^g,d,e,b[h+1],4,-1530992060),g=r(d^e^f,g,d,b[h+4],11,1272893353),f=r(g^d^e,f,g,b[h+7],16,-155497632),e=r(f^g^d,e,f,b[h+10],23,-1094730640),d=r(e^f^g,d,e,b[h+13],4,681279174),g=r(d^e^f,g,d,b[h+0],11,-358537222),f=r(g^d^e,f,g,b[h+3],16,-722521979),e=r(f^g^d,e,f,b[h+6],23,76029189),d=r(e^f^g,d,e,b[h+9],4,-640364487),g=r(d^e^f,g,d,b[h+12],11,-421815835),f=r(g^d^e,f,g,b[h+15],16,530742520),e=r(f^g^d,e,f,b[h+2],23,-995338651),d=u(d,
e,f,g,b[h+0],6,-198630844),g=u(g,d,e,f,b[h+7],10,1126891415),f=u(f,g,d,e,b[h+14],15,-1416354905),e=u(e,f,g,d,b[h+5],21,-57434055),d=u(d,e,f,g,b[h+12],6,1700485571),g=u(g,d,e,f,b[h+3],10,-1894986606),f=u(f,g,d,e,b[h+10],15,-1051523),e=u(e,f,g,d,b[h+1],21,-2054922799),d=u(d,e,f,g,b[h+8],6,1873313359),g=u(g,d,e,f,b[h+15],10,-30611744),f=u(f,g,d,e,b[h+6],15,-1560198380),e=u(e,f,g,d,b[h+13],21,1309151649),d=u(d,e,f,g,b[h+4],6,-145523070),g=u(g,d,e,f,b[h+11],10,-1120210379),f=u(f,g,d,e,b[h+2],15,718787259),
e=u(e,f,g,d,b[h+9],21,-343485551),d=x(d,l),e=x(e,n),f=x(f,p),g=x(g,q);b=[d,e,f,g];d="";for(e=0;e<4*b.length;e++)d+="0123456789abcdef".charAt(b[e>>2]>>e%4*8+4&15)+"0123456789abcdef".charAt(b[e>>2]>>e%4*8&15);k.md5=d;k.imgUrl=F.get("img_"+k.md5)}k.imgUrl?a():(m.open("POST","/yb2015ImageUpload.action",!0),m.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),k="dataStr="+encodeURIComponent(k.src.substr(23))+"&dataSmall="+encodeURIComponent(k.smallBase64.substr(23)),m.send(k))}}var c=
this;A("\u56fe\u7247\u4e0a\u4f20\u4e2d...");this.uploadIndex=-1;for(var l=0,n=0,p=0;p<this.items.length;p++)this.items[p].imgUrl||(l+=this.items[p].smallBase64.length+this.items[p].img.src.length);var m=new XMLHttpRequest;m.onreadystatechange=function(){if(4==m.readyState&&200==m.status){var k=m.responseText;if(k&&/^\d+$/.test(k)){var d;d="";k="http://i0.peopleurl.cn/nmsgimage/wx/"+k.substr(0,10)+"/"+d+k+".jpg";c.items[c.uploadIndex].imgUrl=k;F.set("img_"+c.items[c.uploadIndex].md5,k);n+=c.items[c.uploadIndex].smallBase64.length+
c.items[c.uploadIndex].img.src.length;a()}else alert("\u56fe\u7247\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01code:600"),z()}else 4==m.readyState&&(alert("\u7f51\u7edc\u5fd9\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01code:"+m.status),z())};m.ontimeout=function(a){alert("\u4e0a\u4f20\u8d85\u65f6\uff0c\u8bf7\u5728\u8f83\u597d\u7684\u7f51\u7edc\u73af\u5883\u4e2d\u518d\u8bd5\uff01");z()};m.upload&&(m.upload.onprogress=function(a){a.lengthComputable&&(a=(n+a.loaded)/l,a=1<a?1:a,A("\u56fe\u7247\u4e0a\u4f20\u8fdb\u5ea6<br>"+
Math.round(l/1024)+"k/"+Math.round(100*a)+"%"))});a()},uploadData:function(){var a=new XMLHttpRequest;A("\u4f5c\u54c1\u4e0a\u4f20...");for(var c=[],l,n=0;n<this.items.length;n++)(l=this.items[n].imgUrl.match(/(\d+)\.jpg/i))&&c.push(l[1]);c=c.join("#");a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var c=a.responseText;c&&/^\d+$/.test(c)?(window.localStorage&&(localStorage.ybId=c,localStorage.myYbIdList+="_"+c),A("\u8bf7\u7a0d\u5019..."),setTimeout(function(){window.location.href=
"/h5/paiyuebing/"+c},2E3)):(alert("\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01code:601"),z())}else 4==a.readyState&&(alert("\u4e0a\u4f20\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01code:"+a.status),z())};a.ontimeout=function(a){alert("\u4e0a\u4f20\u8d85\u65f6\uff0c\u8bf7\u5728\u8f83\u597d\u7684\u7f51\u7edc\u73af\u5883\u4e2d\u518d\u8bd5\uff01");z()};a.open("POST","/yb2015Submit.action",!0);a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");a.send("mobile="+
this.phoneNumber+"&imageStr="+encodeURIComponent(c))}},y=document.body.clientWidth,B=document.body.clientHeight,y=640<y?640:y,B=1008<B?1008:B,v=y/640;C(document,"touchmove",function(a){a.preventDefault()});var D=navigator.userAgent.match(/(?:Windows Phone|SymbianOS|Android|iPad|iPod|iPhone)/);(D=D?D[0]:!1)?640>y&&(document.documentElement.style["font-size"]=32*v+"px"):(v=document.documentElement.clientHeight/504*16,y=Math.round(document.documentElement.clientHeight/504*320),document.body.style["font-size"]=
v+"px",document.body.style.overflow="hidden",document.body.style.width=y+"px");w.onbegin=function(){A("\u5904\u7406\u7167\u7247\u4e2d\uff0c\u8bf7\u7a0d\u540e...")};w.onadd=function(a,c){G.addImage(a,c)};w.onprogress=function(a){A("\u5904\u7406\u7167\u7247\u4e2d\uff0c\u8fdb\u5ea6"+Math.round(1E4*a)/100+"%")};w.oncomplete=function(){z()};w.init();w.bind("#addImage");window.showBlurBg=function(a){var c=a.previousSibling;"CANVAS"==c.tagName&&(c.getContext("2d").drawImage(a,0,0,c.width,c.height),stackBlurCanvasRGB(c,
0,0,c.width,c.height,Math.round(c.width/10)))};G.init()}})();
